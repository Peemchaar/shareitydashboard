import{P as De,u as we,o as r,c as d,w as i,b as n,g as c,e as o,t as Ae,d as Se,h as u,S as N,Q as Ue,p as ke,J as Ce,I as F}from"./index.ec32f494.js";import{G as Me,c as K,O as xe,P as X,H as Ie,p as ee}from"./mdi.f693eecd.js";import{u as _e,_ as Ne}from"./NavBar.59cebfca.js";import{_ as oe}from"./CardBox.173aa79f.js";import{_ as s}from"./FormField.c48798ca.js";import{_ as m}from"./FormControl.280616cf.js";import{_ as b}from"./FormFilePicker.184d08bb.js";import{_ as G}from"./BaseButton.674e3c10.js";import{_ as Le}from"./BaseButtons.2d2440b4.js";import{_ as Be}from"./LayoutAuthenticated.0a6b42a9.js";import{s as qe}from"./vue-color-kit.esm-bundler.e50d71a7.js";/* empty css             */import{Z as L}from"./vue-datepicker.1260500d.js";import{_ as y}from"./FormCheckRadio.b41aa598.js";import{S as $e}from"./SponsorController.4f392fe6.js";import{u as ne,S as le}from"./ServerCall.7354e88a.js";import{C as ae}from"./ChallengeController.9b8120ad.js";import{O as Ee}from"./OrganizationController.cf89c48d.js";import{U as V}from"./utilityMethods.670eb443.js";import{U as ze}from"./UserController.5f62944b.js";import"./_plugin-vue_export-helper.cdc0426e.js";import"./BaseIcon.dec28c75.js";import"./colors.dcae2bc6.js";import"./LoginController.9d60cd79.js";const Oe=ne(),te={getAll:async()=>{try{return(await le.get("/animation/get")).data}catch(f){throw f}},create:async f=>{try{console.log("animation data to send: ",f);const g=Oe.getUserId(),h=parseInt(f.duration)*1e3;return(await le.post("/animation/create",{idUsr:parseInt(g),name:f.name,duration:h.toString(),format:f.format,recource:f.recource})).data}catch(g){throw console.log(g),g}}},Re={class:"flex justify-between pb-5"},Te={class:"flex gap-2 items-center"},Qe={class:"font-extrabold"},je={class:"grid grid-cols-3 lg:grid-cols-4 gap-6"},Ge={class:"grid grid-cols-1 lg:grid-cols-2 gap-3"},Pe={class:"flex flex-row"},He={style:{position:"relative"}},We={style:{position:"absolute"}},Ze=c("p",{class:"text-xl font-bold"},[F(" CHALLENGE PREVIEW "),c("br"),c("br"),F(" COMING SOON... ")],-1),vo={__name:"CreateChallengeView",setup(f){const g="https://chgsdev.shareity.com/",h=De(),P=we(),B=[{id:1,label:"Picture"},{id:2,label:"Selfie"},{id:3,label:"Video"},{id:4,label:"Audio"},{id:5,label:"Game"},{id:6,label:"Animation Image"},{id:7,label:"Animation Video"},{id:8,label:"Animation Share No Donate Image"},{id:9,label:"Animation Share No Donate Video"},{id:10,label:"No Donate Video"},{id:11,label:"No Donate Meta Image"},{id:12,label:"No Donate Meta Video"}],A=[{id:1,label:"Yes"},{id:2,label:"No"}],ie=ref(),v=ref(),D=ref(),S=ref(),U=ref(),k=ref([]),q=ref([]),C=ref([]),M=ref(),$=ref(),E=ref(),z=ref(),x=ref(),O=ref(),I=ref(),_=ref(),R=ref(!1),T=_e(),H=ne(),e=reactive({name:"",description:"",amount:"",maxAmount:"",donateName:"",instructions:"",shareMessage:"",shareMessageShort:"",type:B[0],organization:C[0],sponsor:k[0],animation:q[0],inviteDonate:A[0],haveSponsor:!1,typeDonation:!1,typeDonationName:"",addLighBeat:!1,reactions:!1,addIntroduction:!1,addInstructions:!1,newAnimation:!1,newAnimationName:"",newAnimationDuration:""}),Q=h.query.id?"Edit":"Create";watchEffect(()=>{$e.getAll().then(a=>{let l=a.map(t=>({id:t.id,label:t.name}));k.value=l,e.sponsor=l[0]}),te.getAll().then(a=>{let l=a.map(t=>({id:t.id,label:t.name}));q.value=l,e.animation=l[0]}),Ee.getAll().then(a=>{let l=a.map(t=>({id:t.id,label:t.name}));C.value=l,e.organization=l[0]}),h.query.id&&ae.getById(h.query.id).then(a=>{console.log("data-challenge: ",a),ie.value=a,e.badge=g+a.badge,e.url=g+a.url,x.value=g+a.typeDonationIcon,v.value=a.startDate,D.value=a.endDate,e.name=a.name,e.description=a.description,e.amount=a.amount,e.maxAmount=a.maxAmount,e.donateName=a.donateName,e.instructions=a.instructions,e.shareMessage=a.shareMessage,e.shareMessageShort=a.shareMessageShort,e.type=B.filter(l=>l.id===a.resource.id)[0],e.organization=C.value.filter(l=>l.id===a.organization.id)[0],e.sponsor=a.sponsors.length>0?k.value.filter(l=>l.id===a.sponsors[0].id)[0]:null,e.typeDonationName=a.typeDonationDescription,e.inviteDonate=a.inviteDonate==1?A[0]:A[1],e.haveSponsor=a.sponsors.length==0,e.typeDonation=a.typeDonation==="object",e.addLighBeat=!!a.lightbeatStartDate,e.reactions=a.reactions==1,e.addInstructions=a.instructions!=""})},[h.query.id]);const p=reactive({showcolorpicker:!1,color:"#59c7f9",suckerCanvas:null,suckerArea:[],isSucking:!1}),se=a=>{p.color=a.hex},re=a=>{console.log("newValue-create:",a),M.value=a},de=a=>{$.value=a},ue=a=>{z.value=a},me=a=>{x.value=a},ce=a=>{O.value=a},pe=a=>{I.value=a},fe=a=>{E.value=a},ge=a=>{_.value=a},be=async()=>{if(R.value=!0,e.newAnimation){let w=await V.verifyMedia(E.value,"animations"),ve={recource:w,duration:e.newAnimationDuration,name:e.newAnimationName,format:w.split(".")[1]};e.animation=await te.create(ve)}let a="";e.addLighBeat&&(a=await V.verifyMedia(z.value,"challenges"));let l=await V.verifyMedia(M.value,"challenges");console.log("pruebita",M.value);let t=await V.verifyMedia($.value,"challenges"),W="";e.typeDonation&&(W=await V.verifyMedia(x.value,"challenges"));let Z="";e.addIntroduction&&(Z=await V.verifyMedia(O.value,"challenges"));let J="";I.value!=null&&(J=await V.verifyMedia(I.value,"animations"));let j="";_.value!=null&&(j=await V.verifyMedia(_.value,"challenges")),console.log("qr",j);let Ve={name:e.name,description:e.description,startDate:v.value,endDate:D.value,amount:e.amount,inviteDonate:e.inviteDonate.id==1,maxAmount:e.maxAmount,lightbeatStartDate:S.value,lightbeatEndDate:U.value,shareMessage:e.shareMessage,shareMessageShort:e.shareMessageShort,reactions:e.reactions,color:p.color,instructions:e.instructions,typeDonation:e.typeDonation?"object":"money",typeDonationDescription:e.typeDonationName,idAnimation:e.animation.id,idSponsor:e.sponsor.id,idResource:e.type.id,idOrganization:e.organization.id,badge:l,url:t,lightbeatDesign:a,typeDonationIcon:W,introduction:Z,animation:J,customQr:j},he=H.getUserId(),ye=H.getUserRole(),Y=1;ye!="admin"&&(Y=await ze.getCredit(he)),Y>0?await ae.createChallenge(Ve).then(w=>{T.createAlert({title:"Challenge Created!",icon:"$success",text:"the challenge has been created successfully!"}),P.push("/campaigns")}).catch(w=>{T.createAlert({title:"Error!",color:"error",icon:"$warning",text:"We could not create the challenge!"}),console.log("error",w)}).finally(()=>{R.value=!1}):T.createAlert({title:"Insufficient credits",color:"error",icon:"$warning",text:"Acquires more credits to create a challenge"})};return(a,l)=>(r(),d(Be,null,{default:i(()=>[n(Ne,null,{default:i(()=>[c("div",Re,[c("div",Te,[n(G,{icon:o(Me),to:"/campaigns",color:"info","rounded-full":"",small:""},null,8,["icon"]),c("p",Qe,Ae(o(Q))+" Challenge",1)])]),c("div",je,[n(oe,{"is-form":"",class:"col-span-3",onSubmit:Se(be,["prevent"])},{footer:i(()=>[n(Le,{class:"justify-end"},{default:i(()=>[o(e)?(r(),d(G,{key:0,color:"info",type:"submit",label:"Save",isLoading:o(R)},null,8,["isLoading"])):u("",!0)]),_:1})]),default:i(()=>[c("div",Ge,[n(s,{label:"Challenge Name",help:"Required."},{default:i(()=>[n(m,{modelValue:o(e).name,"onUpdate:modelValue":l[0]||(l[0]=t=>o(e).name=t),icon:o(K),name:"challengeName",required:"",autocomplete:"challengeName"},null,8,["modelValue","icon"])]),_:1}),n(s,{label:"Challenge Description",help:"Required."},{default:i(()=>[n(m,{modelValue:o(e).description,"onUpdate:modelValue":l[1]||(l[1]=t=>o(e).description=t),icon:o(xe),name:"description",required:"",autocomplete:"description",label:"data"},null,8,["modelValue","icon"])]),_:1}),n(s,{label:"Badge Image",help:"Max 500kb"},{default:i(()=>[n(b,{label:"Upload",modelValue:o(M),"onUpdate:modelValue":re,mediaClass:"h-24 w-24 mt-3",required:""},null,8,["modelValue"])]),_:1}),n(s,{label:"Challenge Background",help:"Max 500kb"},{default:i(()=>[n(b,{label:"Upload",modelValue:o($),"onUpdate:modelValue":de,mediaClass:"w-full h-96",required:""},null,8,["modelValue"])]),_:1}),n(s,{label:"Type"},{default:i(()=>[n(m,{modelValue:o(e).type,"onUpdate:modelValue":l[2]||(l[2]=t=>o(e).type=t),options:B,icon:a.mdiCity},null,8,["modelValue","icon"])]),_:1}),n(s,{label:"Organization"},{default:i(()=>[n(m,{modelValue:o(e).organization,"onUpdate:modelValue":l[3]||(l[3]=t=>o(e).organization=t),options:o(C),icon:a.mdiCity},null,8,["modelValue","options","icon"])]),_:1}),n(s,{label:"Select an Animation"},{default:i(()=>[n(m,{disabled:o(Q)=="Edit",modelValue:o(e).animation,"onUpdate:modelValue":l[4]||(l[4]=t=>o(e).animation=t),type:"text",options:o(q),icon:a.mdiAnimation},null,8,["disabled","modelValue","options","icon"])]),_:1}),n(s,{label:"New Animation"},{default:i(()=>[n(y,{modelValue:o(e).newAnimation,"onUpdate:modelValue":l[5]||(l[5]=t=>o(e).newAnimation=t),type:"checkbox",label:"Or upload a new one"},null,8,["modelValue"])]),_:1}),o(e).newAnimation?(r(),d(s,{key:0,label:"Upload new animation",help:"Max 500kb"},{default:i(()=>[n(b,{label:"Upload",modelValue:o(E),"onUpdate:modelValue":fe,mediaClass:"w-full h-96"},null,8,["modelValue"])]),_:1})):u("",!0),o(e).newAnimation?(r(),d(s,{key:1,label:"Animation name",help:"Required."},{default:i(()=>[n(m,{modelValue:o(e).newAnimationName,"onUpdate:modelValue":l[6]||(l[6]=t=>o(e).newAnimationName=t),icon:a.mdiAnimation,name:"animationName",required:"",autocomplete:"newAnimationName"},null,8,["modelValue","icon"])]),_:1})):u("",!0),o(e).newAnimation?(r(),d(s,{key:2,label:"Animation duration (seconds)",help:"Required."},{default:i(()=>[n(m,{modelValue:o(e).newAnimationDuration,"onUpdate:modelValue":l[7]||(l[7]=t=>o(e).newAnimationDuration=t),icon:a.mdiAnimation,name:"animationDuration",required:"",autocomplete:"5"},null,8,["modelValue","icon"])]),_:1})):u("",!0),n(s,{label:"Type"},{default:i(()=>[n(y,{modelValue:o(e).haveSponsor,"onUpdate:modelValue":l[8]||(l[8]=t=>o(e).haveSponsor=t),type:"checkbox",label:"Unsponsored?"},null,8,["modelValue"])]),_:1}),o(e).haveSponsor?u("",!0):(r(),d(s,{key:3,label:"Sponsor"},{default:i(()=>[n(m,{disabled:o(Q)=="Edit",modelValue:o(e).sponsor,"onUpdate:modelValue":l[9]||(l[9]=t=>o(e).sponsor=t),type:"text",options:o(k),icon:a.mdiCity},null,8,["disabled","modelValue","options","icon"])]),_:1})),n(s,{label:"Start Date"},{default:i(()=>[n(o(L),{modelValue:o(v),"onUpdate:modelValue":l[10]||(l[10]=t=>N(v)?v.value=t:null)},null,8,["modelValue"])]),_:1}),n(s,{label:"End Date"},{default:i(()=>[n(o(L),{modelValue:o(D),"onUpdate:modelValue":l[11]||(l[11]=t=>N(D)?D.value=t:null)},null,8,["modelValue"])]),_:1}),n(s,null,{default:i(()=>[n(y,{modelValue:o(e).typeDonation,"onUpdate:modelValue":l[12]||(l[12]=t=>o(e).typeDonation=t),type:"checkbox",label:"Something Different Than Money?"},null,8,["modelValue"])]),_:1}),o(e).typeDonation?u("",!0):(r(),d(s,{key:4,label:"Invite Donate"},{default:i(()=>[n(m,{modelValue:o(e).inviteDonate,"onUpdate:modelValue":l[13]||(l[13]=t=>o(e).inviteDonate=t),type:"text",options:A},null,8,["modelValue"])]),_:1})),o(e).typeDonation?u("",!0):(r(),d(s,{key:5,label:"Amount Per Challenge ($)"},{default:i(()=>[n(m,{modelValue:o(e).amount,"onUpdate:modelValue":l[14]||(l[14]=t=>o(e).amount=t),icon:o(X)},null,8,["modelValue","icon"])]),_:1})),o(e).typeDonation?u("",!0):(r(),d(s,{key:6,label:"Maximun Donation ($)"},{default:i(()=>[n(m,{modelValue:o(e).maxAmount,"onUpdate:modelValue":l[15]||(l[15]=t=>o(e).maxAmount=t),icon:o(X)},null,8,["modelValue","icon"])]),_:1})),o(e).typeDonation?(r(),d(s,{key:7,label:"Name"},{default:i(()=>[n(m,{modelValue:o(e).typeDonationName,"onUpdate:modelValue":l[16]||(l[16]=t=>o(e).typeDonationName=t),icon:o(K)},null,8,["modelValue","icon"])]),_:1})):u("",!0),o(e).typeDonation?(r(),d(s,{key:8,label:"Select Image",help:"Max 500kb"},{default:i(()=>[n(b,{label:"Upload",modelValue:o(x),"onUpdate:modelValue":me,mediaClass:"h-24 w-24 mt-3"},null,8,["modelValue"])]),_:1})):u("",!0),n(s,null,{default:i(()=>[n(y,{modelValue:o(e).addLighBeat,"onUpdate:modelValue":l[17]||(l[17]=t=>o(e).addLighBeat=t),type:"checkbox",label:"Add LightBeat To This Challenge"},null,8,["modelValue"])]),_:1}),o(e).addLighBeat?(r(),d(s,{key:9,label:"Select Lightbeat Design"},{default:i(()=>[n(b,{label:"Upload",modelValue:o(z),"onUpdate:modelValue":ue},null,8,["modelValue"])]),_:1})):u("",!0),o(e).addLighBeat?(r(),d(s,{key:10,label:"Start Lightbeat Date"},{default:i(()=>[n(o(L),{modelValue:o(S),"onUpdate:modelValue":l[18]||(l[18]=t=>N(S)?S.value=t:null)},null,8,["modelValue"])]),_:1})):u("",!0),o(e).addLighBeat?(r(),d(s,{key:11,label:"End Lightbeat Date"},{default:i(()=>[n(o(L),{modelValue:o(U),"onUpdate:modelValue":l[19]||(l[19]=t=>N(U)?U.value=t:null)},null,8,["modelValue"])]),_:1})):u("",!0),n(y,{modelValue:o(e).reactions,"onUpdate:modelValue":l[20]||(l[20]=t=>o(e).reactions=t),type:"checkbox",label:"Do you want members to react to your challenge?"},null,8,["modelValue"]),o(e).addIntroduction?(r(),d(s,{key:12,label:"Select Introduction Video"},{default:i(()=>[n(b,{label:"Upload",modelValue:o(O),"onUpdate:modelValue":ce},null,8,["modelValue"])]),_:1})):u("",!0),n(s,null,{default:i(()=>[n(y,{modelValue:o(e).addInstructions,"onUpdate:modelValue":l[21]||(l[21]=t=>o(e).addInstructions=t),type:"checkbox",label:"Do you want to add instructions to this challenge?"},null,8,["modelValue"])]),_:1}),o(e).addInstructions?(r(),d(s,{key:13,label:"Challenge instructions"},{default:i(()=>[n(m,{modelValue:o(e).instructions,"onUpdate:modelValue":l[22]||(l[22]=t=>o(e).instructions=t),icon:o(Ie)},null,8,["modelValue","icon"])]),_:1})):u("",!0),n(s,{label:"Social Media Sharing Text"},{default:i(()=>[n(m,{modelValue:o(e).shareMessage,"onUpdate:modelValue":l[23]||(l[23]=t=>o(e).shareMessage=t),icon:o(ee)},null,8,["modelValue","icon"])]),_:1}),n(s,{label:"Social Media Sharing Text (Short)"},{default:i(()=>[n(m,{modelValue:o(e).shareMessageShort,"onUpdate:modelValue":l[24]||(l[24]=t=>o(e).shareMessageShort=t),icon:o(ee)},null,8,["modelValue","icon"])]),_:1}),n(s,{label:"Banner Color"},{default:i(()=>[c("div",Pe,[n(G,{onClick:l[25]||(l[25]=t=>o(p).showcolorpicker=!o(p).showcolorpicker),class:"text-black w-full",label:"Select Color"}),c("div",{class:"ml-2 h-12 w-24 rounded-md",style:Ue({background:o(p).color})},null,4)]),c("div",He,[ke(c("div",We,[n(o(qe),{theme:"light",color:o(p).color,"sucker-hide":!1,"sucker-canvas":o(p).suckerCanvas,"sucker-area":o(p).suckerArea,onChangeColor:se,onOpenSucker:o(p).openSucker},null,8,["color","sucker-canvas","sucker-area","onOpenSucker"])],512),[[Ce,o(p).showcolorpicker]])])]),_:1}),n(s,{label:"Select Custom QR"},{default:i(()=>[n(b,{label:"Upload",modelValue:o(_),"onUpdate:modelValue":ge,mediaClass:"h-52 w-52"},null,8,["modelValue"])]),_:1}),n(s,{label:"Select Advertisement Animation"},{default:i(()=>[n(b,{label:"Upload",modelValue:o(I),"onUpdate:modelValue":pe,mediaClass:"h-52 w-52"},null,8,["modelValue"])]),_:1})])]),_:1},8,["onSubmit"]),n(oe,{class:"col-span-full lg:col-span-1 text-center items-center justify-center"},{default:i(()=>[Ze]),_:1})])]),_:1})]),_:1}))}};export{vo as default};
